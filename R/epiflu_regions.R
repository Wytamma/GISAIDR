# Function to look up continent and region IDs from a mixed list (case insensitive)
lookup_region_ids <- function(mixed_list) {
  # Initialize vectors to store IDs
  continent_id_vec <- numeric(0)
  region_id_vec <- numeric(0)

  for (place in mixed_list) {
    # Convert place to lowercase and replace spaces with underscores
    place_key <- gsub(" ", "_", tolower(place))

    # Check if the place is a continent
    if(place_key %in% names(epiflu_continent_ids)) {
      continent_id_vec <- c(continent_id_vec, as.character(epiflu_continent_ids[place_key]))
    }
    # Check if the place is a region
    else if (place_key %in% names(epiflu_region_ids)) {
      region_id_vec <- c(region_id_vec, as.character(epiflu_region_ids[place_key]))
    }
    else {
      stop(paste("Place not found:", place))
    }
  }
  if (identical(continent_id_vec, numeric(0))) {
    continent_id_vec <- c("0")
  }
  if (identical(region_id_vec, numeric(0))) {
    region_id_vec <- c("0")
  }
  # Return lists of IDs without names
  return(list(list(unname(continent_id_vec)), list(unname(region_id_vec))))
}

epiflu_continent_ids <-
  c(
    africa = 1001,
    antarctica = 1945,
    asia = 1952,
    europe = 3069,
    north_america = 6440,
    oceania = 9990,
    south_america = 10053
  )

# africa
epiflu_region_ids <- c(
  algeria = 1002,
  angola = 1051,
  benin = 1070,
  botswana = 1083,
  burkina_faso = 1094,
  burundi = 1140,
  cameroon = 1157,
  cape_verde = 1168,
  central_african_republic = 1186,
  chad = 1204,
  comoros = 1219,
  congo_republic_of = 1664,
  congo_democatic_republic_of = 1243,
  cote_d_ivoire = 1223,
  djibouti = 1256,
  egypt = 1263,
  equatorial_guinea = 1290,
  eritrea = 1298,
  ethiopia = 1305,
  gabon = 1318,
  gambia = 1328,
  ghana = 1335,
  guinea = 1346,
  guinea_bissau = 1381,
  kenya = 1391,
  lesotho = 1400,
  liberia = 1411,
  libyan_arab_jamahiriya = 1427,
  madagascar = 1476,
  malawi = 1483,
  mali = 1511,
  mauritania = 1521,
  mauritius = 1535,
  mayotte = 1548,
  morocco = 1549,
  mozambique = 1565,
  namibia = 1577,
  niger = 1615,
  nigeria = 1625,
  reunion = 1676,
  rwanda = 1677,
  saint_helena = 1693,
  sao_tome_and_principe = 1694,
  senegal = 1696,
  seychelles = 1708,
  sierra_leone = 1735,
  somalia = 1740,
  south_africa = 1759,
  sudan = 1769,
  south_sudan = 15498,
  swaziland = 1802,
  tanzania = 1807,
  togo = 1834,
  tunisia = 1840,
  uganda = 1866,
  western_sahara = 1923,
  zambia = 1925,
  zimbabwe = 1935,

  # antarctica and surrounding islands
  antarctica = 1946,
  bouvet_island = 1947,
  french_southern_territories = 1948,
  heard_island_and_mcdonald_islands = 1950,
  south_georgia_and_the_south_sandwich_islands = 1951,

  # asia
  afghanistan = 1953,
  armenia = 1985,
  azerbaijan = 1997,
  bahrain = 2069,
  bangladesh = 2082,
  bhutan = 2087,
  british_indian_ocean_territory = 2106,
  brunei = 2107,
  cambodia = 2108,
  china = 2128,
  christmas_island = 2160,
  georgia = 2162,
  hong_kong_sar = 2227,
  india = 2228,
  indonesia = 2264,
  iran = 2298,
  iraq = 2330,
  israel = 2349,
  japan = 2356,
  jordan = 2404,
  kazakhstan = 2415,
  korea_democratic_peoples_republic_of = 2558,
  korea_republic_of = 2750,
  kuwait = 2434,
  kyrgyzstan = 2441,
  lao_peoples_democratic_republic = 2450,
  lebanon = 2468,
  macao = 2477,
  malaysia = 2480,
  maldives = 2497,
  mongolia = 2518,
  myanmar = 2541,
  nepal = 2556,
  oman = 2572,
  pakistan = 2580,
  palestinian_territory = 2588,
  philippines = 2591,
  qatar = 2724,
  saudi_arabia = 2735,
  singapore = 2749,
  sri_lanka = 15494,
  syrian_arab_republic = 2767,
  taiwan = 2782,
  tajikistan = 2787,
  thailand = 2793,
  turkey = 2873,
  turkmenistan = 2955,
  united_arab_emirates = 2961,
  uzbekistan = 2969,
  vietnam = 2984,
  yemen = 3053,

  # europe
  aland_islands = 3070,
  albania = 3071,
  andorra = 3084,
  austria = 3092,
  belarus = 3102,
  belgium = 3110,
  bosnia_and_herzegovina = 3123,
  bulgaria = 3126,
  croatia = 3417,
  cyprus = 3439,
  czech_republic = 3446,
  denmark = 3538,
  estonia = 3640,
  faroe_islands = 3656,
  finland = 3658,
  france = 3665,
  germany = 3784,
  gibraltar = 3823,
  greece = 3824,
  guernsey = 3877,
  holy_see_vatican_city_state = 6438,
  hungary = 3878,
  iceland = 3920,
  ireland = 3929,
  isle_of_man = 3956,
  italy = 3957,
  jersey = 4084,
  kosovo = 6439,
  latvia = 4086,
  liechtenstein = 4117,
  lithuania = 4129,
  luxembourg = 4140,
  macedonia_the_former_yogoslav_republic_of = 4144,
  malta = 4268,
  moldova_republic_of = 4269,
  monaco = 4309,
  montenegro = 4310,
  netherlands = 4312,
  norway = 4749,
  poland = 5201,
  portugal = 5218,
  romania = 5239,
  russian_federation = 5283,
  san_marino = 5373,
  serbia = 5383,
  slovakia = 5387,
  slovenia = 5396,
  spain = 5590,
  svalbard_and_jan_mayen = 5657,
  sweden = 5658,
  switzerland = 5969,
  ukraine = 6180,
  united_kingdom = 6208,

  # north america
  anguilla = 6441,
  antigua_and_barbuda = 6442,
  aruba = 6450,
  bahamas = 6451,
  barbados = 6473,
  belize = 6485,
  bermuda = 6492,
  british_virgin_islands = 6504,
  canada = 6505,
  cayman_islands = 6519,
  costa_rica = 6520,
  cuba = 6528,
  dominica = 6544,
  dominican_republic = 6555,
  el_salvador = 6588,
  greenland = 6603,
  grenada = 6604,
  guadeloupe = 6611,
  guatemala = 6612,
  haiti = 6635,
  honduras = 6645,
  jamaica = 6664,
  martinique = 6679,
  mexico = 6680,
  montserrat = 6713,
  netherlands_antilles = 6717,
  nicaragua = 6718,
  panama = 6736,
  puerto_rico = 6747,
  saint_kitts_and_nevis = 6748,
  saint_lucia = 6763,
  saint_martin_french_part = 15495,
  saint_pierre_and_miquelon = 6775,
  saint_vincent_and_the_grenadines = 6776,
  trinidad_and_tobago = 6783,
  turks_and_caicos_islands = 6796,
  united_states = 6798,
  virgin_islands = 6797,

  # oceania
  american_samoa = 9991,
  australia = 9992,
  cook_islands = 10001,
  fiji = 10004,
  french_polynesia = 10010,
  guam = 10011,
  kiribati = 10012,
  marshall_islands = 10013,
  micronesia_federated_states_of = 10014,
  nauru = 10019,
  new_caledonia = 10020,
  new_zealand = 10021,
  niue = 10037,
  norfolk_island = 10038,
  northern_mariana_islands = 10039,
  palau = 10040,
  papua_new_guinea = 10041,
  pitcairn = 10043,
  samoa = 10044,
  solomon_islands = 10045,
  timor_leste = 10002,
  tokelau = 10047,
  tonga = 10048,
  tuvalu = 10049,
  united_states_minor_outlying_islands = 10050,
  vanuatu = 10051,
  wallis_and_futuna = 10052,

  # south/central america
  argentina = 10054,
  bolivia_plurinationial_state_of = 10079,
  brazil = 10182,
  chile = 15309,
  colombia = 15323,
  ecuador = 15356,
  falkland_islands = 15379,
  islas_malvinas = 15379,
  french_guiana = 15380,
  guyana = 15381,
  paraguay = 15392,
  peru = 15411,
  suriname = 15437,
  uruguay = 15448,
  venezuela_bolivarian_republic_of = 15468
)
